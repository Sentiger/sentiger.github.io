import{_ as n}from"./plugin-vue_export-helper.21dcd24c.js";import{o as s,c as a,e as t}from"./app.46927fa7.js";var p="/assets/channel-status.bed1fe11.png";const e={},o=t('<p>go\u534F\u7A0B\u4E2D\u64CD\u4F5Cchannel\u4E4B\u524D\u6CA1\u6709\u5224\u65AD\u662F\u5426\u5173\u95ED\u7684\u51FD\u6570\u3002\u5728\u591A\u4E2A\u534F\u7A0B\u4E4B\u95F4\u901A\u4FE1\u4E5F\u90FD\u662F\u4F9D\u9760\u4E8Echannel\uFF0C\u6240\u4EE5\u53CB\u597D\u901A\u77E5\u5404\u4E2A\u534F\u7A0B\u6BD4\u8F83\u91CD\u8981\u3002</p><p><img src="'+p+`" alt="channel\u901A\u77E5" loading="lazy"></p><h2 id="\u901A\u9053\u5173\u95ED\u539F\u5219" tabindex="-1"><a class="header-anchor" href="#\u901A\u9053\u5173\u95ED\u539F\u5219" aria-hidden="true">#</a> \u901A\u9053\u5173\u95ED\u539F\u5219</h2><ul><li>\u60C5\u5F62\u4E00\uFF1AM\u4E2A\u63A5\u6536\u8005\u548C\u4E00\u4E2A\u53D1\u9001\u8005\uFF0C\u53D1\u9001\u8005\u901A\u8FC7\u5173\u95ED\u7528\u6765\u4F20\u8F93\u6570\u636E\u7684\u901A\u9053\u6765\u4F20\u9012\u53D1\u9001\u7ED3\u675F\u4FE1\u53F7\u3002</li><li>\u60C5\u5F62\u4E8C\uFF1A\u4E00\u4E2A\u63A5\u6536\u8005\u548CN\u4E2A\u53D1\u9001\u8005\uFF0C\u6B64\u552F\u4E00\u63A5\u6536\u8005\u901A\u8FC7\u5173\u95ED\u4E00\u4E2A\u989D\u5916\u7684\u4FE1\u53F7\u901A\u9053\u6765\u901A\u77E5\u53D1\u9001\u8005\u4E0D\u8981\u518D\u53D1\u9001\u6570\u636E\u4E86\u3002</li><li>\u60C5\u5F62\u4E09\uFF1AM\u4E2A\u63A5\u6536\u8005\u548CN\u4E2A\u53D1\u9001\u8005\uFF0C\u5B83\u4EEC\u4E2D\u7684\u4EFB\u4F55\u534F\u7A0B\u90FD\u53EF\u4EE5\u8BA9\u4E00\u4E2A\u4E2D\u95F4\u8C03\u89E3\u534F\u7A0B\u5E2E\u5FD9\u53D1\u51FA\u505C\u6B62\u6570\u636E\u4F20\u9001\u7684\u4FE1\u53F7\u3002</li></ul><div class="custom-container danger"><p class="custom-container-title">\u8B66\u544A</p><p>\u5173\u4E8E\u901A\u9053\u548C\u534F\u7A0B\u7684\u5783\u573E\u56DE\u6536</p><p>\u6CE8\u610F\uFF0C\u4E00\u4E2A\u901A\u9053\u88AB\u5176\u53D1\u9001\u6570\u636E\u534F\u7A0B\u961F\u5217\u548C\u63A5\u6536\u6570\u636E\u534F\u7A0B\u961F\u5217\u4E2D\u7684\u6240\u6709\u534F\u7A0B\u5F15\u7528\u7740\u3002\u56E0\u6B64\uFF0C\u5982\u679C\u4E00\u4E2A\u901A\u9053\u7684\u8FD9\u4E24\u4E2A\u961F\u5217\u53EA\u8981\u6709\u4E00\u4E2A\u4E0D\u4E3A\u7A7A\uFF0C\u5219\u6B64\u901A\u9053\u80AF\u5B9A\u4E0D\u4F1A\u88AB\u5783\u573E\u56DE\u6536\u3002\u53E6\u4E00\u65B9\u9762\uFF0C\u5982\u679C\u4E00\u4E2A\u534F\u7A0B\u5904\u4E8E\u4E00\u4E2A\u901A\u9053\u7684\u67D0\u4E2A\u534F\u7A0B\u961F\u5217\u4E4B\u4E2D\uFF0C\u5219\u6B64\u534F\u7A0B\u4E5F\u80AF\u5B9A\u4E0D\u4F1A\u88AB\u5783\u573E\u56DE\u6536\uFF0C\u5373\u4F7F\u6B64\u901A\u9053\u4EC5\u88AB\u6B64\u534F\u7A0B\u6240\u5F15\u7528\u3002\u4E8B\u5B9E\u4E0A\uFF0C\u4E00\u4E2A\u534F\u7A0B\u53EA\u6709\u5728\u9000\u51FA\u540E\u624D\u80FD\u88AB\u5783\u573E\u56DE\u6536\u3002</p><p>\u603B\u7ED3\uFF1A\u4E0D\u80FD\u5173\u95ED\u4E00\u4E2A\u6709\u5176\u4ED6\u534F\u7A0B\u5199\u5165\u7684channel\u3002\u53EF\u4EE5\u8BA9channel\u90FD\u6CA1\u6709\u4EFB\u4F55\u534F\u7A0B\u5F15\u7528\uFF0C\u81EA\u52A8\u88AB\u5783\u573E\u56DE\u6536\u6389\u3002</p></div><h2 id="\u573A\u666F\u793A\u4F8B" tabindex="-1"><a class="header-anchor" href="#\u573A\u666F\u793A\u4F8B" aria-hidden="true">#</a> \u573A\u666F\u793A\u4F8B</h2><p>\u4E0B\u9762\u4E09\u4E2A\u793A\u4F8B\u5206\u522B\u5C55\u793A\u4E0A\u9762\u4E09\u4E2A\u60C5\u5F62</p><h3 id="m\u4E2A\u63A5\u6536\u8005\u548C\u4E00\u4E2A\u53D1\u9001\u8005" tabindex="-1"><a class="header-anchor" href="#m\u4E2A\u63A5\u6536\u8005\u548C\u4E00\u4E2A\u53D1\u9001\u8005" aria-hidden="true">#</a> M\u4E2A\u63A5\u6536\u8005\u548C\u4E00\u4E2A\u53D1\u9001\u8005</h3><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>
<span class="token keyword">func</span> <span class="token function">TestOneWriteMoreReceive</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>runtime<span class="token punctuation">.</span><span class="token function">NumGoroutine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token function">onceWrite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>runtime<span class="token punctuation">.</span><span class="token function">NumGoroutine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u5355\u534F\u7A0B\u53D1\u9001\u6570\u636E\uFF0C\u7136\u540E\u5173\u95ED\u901A\u9053</span>
<span class="token keyword">func</span> <span class="token function">onceWrite</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ch <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
	wg <span class="token operator">:=</span> <span class="token operator">&amp;</span>sync<span class="token punctuation">.</span>WaitGroup<span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
			ch <span class="token operator">&lt;-</span> i
		<span class="token punctuation">}</span>
		<span class="token function">close</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">{</span>
		wg<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token keyword">go</span> <span class="token function">receive</span><span class="token punctuation">(</span>ch<span class="token punctuation">,</span> wg<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	wg<span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">receive</span><span class="token punctuation">(</span>ch <span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span> wg <span class="token operator">*</span>sync<span class="token punctuation">.</span>WaitGroup<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> wg<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> <span class="token punctuation">{</span>
		num<span class="token punctuation">,</span> ok <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch
		<span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token punctuation">{</span>
			<span class="token keyword">break</span>
		<span class="token punctuation">}</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;\u5F00\u59CB\u8BFB\u53D6\u5230\u6570\u636E\u4E86\uFF0C\u5F00\u59CB\u5904\u7406&quot;</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span>
		time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;\u5904\u7406\u5B8C\u6570\u636E\u4E86&quot;</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;\u534F\u7A0B\u5173\u95ED\u4E86,\u9000\u51FA\u534F\u7A0B&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u4E00\u4E2A\u63A5\u53D7\u8005n\u4E2A\u53D1\u9001\u8005" tabindex="-1"><a class="header-anchor" href="#\u4E00\u4E2A\u63A5\u53D7\u8005n\u4E2A\u53D1\u9001\u8005" aria-hidden="true">#</a> \u4E00\u4E2A\u63A5\u53D7\u8005N\u4E2A\u53D1\u9001\u8005</h2><p>\u6CE8\u610F\uFF1A\u8FD9\u91CC\u662F\u63A5\u4F4F\u4E00\u4E2Achannel\u6765\u901A\u77E5\u534F\u7A0B\u5173\u95ED\uFF0C\u800C\u4E0D\u662F\u76F4\u63A5close(dataCh),\u6211\u4EEC\u8BA9\u6570\u636E\u534F\u7A0B\u901A\u8FC7\u5783\u573E\u56DE\u6536\uFF0C\u4E3B\u52A8\u5173\u95ED\uFF0C\u5199\u5165\u534F\u7A0B\u53EF\u80FD\u4F1A\u62A5\u9519\u3002\u56E0\u4E3Aselect\u4F1A\u5C1D\u8BD5\u5199\u5165\uFF0C\u5224\u65AD\u662F\u5426\u963B\u585E\u3002\u6240\u4EE5\u4E0D\u80FD\u5173\u95ED</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>
<span class="token keyword">func</span> <span class="token function">TestMoreWriteOneReceive</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>runtime<span class="token punctuation">.</span><span class="token function">NumGoroutine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	ch <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
	cancel <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token keyword">go</span> <span class="token function">moreWrite</span><span class="token punctuation">(</span>ch<span class="token punctuation">,</span> cancel<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token keyword">range</span> ch <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
		<span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">10</span> <span class="token punctuation">{</span>
			<span class="token function">close</span><span class="token punctuation">(</span>cancel<span class="token punctuation">)</span>
			<span class="token keyword">break</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;\u7ED3\u675F\u4E86&quot;</span><span class="token punctuation">)</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;\u534F\u7A0B\u6570\u91CF&quot;</span><span class="token punctuation">,</span> runtime<span class="token punctuation">.</span><span class="token function">NumGoroutine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">moreWrite</span><span class="token punctuation">(</span>ch <span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span> cancel <span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">,</span> num <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	i <span class="token operator">:=</span> <span class="token number">0</span>
	<span class="token keyword">for</span> <span class="token punctuation">{</span>
		i<span class="token operator">++</span>
		<span class="token keyword">select</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> ch <span class="token operator">&lt;-</span> i<span class="token punctuation">:</span>
		<span class="token keyword">case</span> <span class="token operator">&lt;-</span>cancel<span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;\u5DE5\u4F5C\u534F\u7A0B\u63A5\u6536\u5230\u4E86\u4FE1\u53F7\u9000\u51FA\u4E86&quot;</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="m\u4E2A\u63A5\u53D7\u8005n\u4E2A\u53D1\u9001\u8005" tabindex="-1"><a class="header-anchor" href="#m\u4E2A\u63A5\u53D7\u8005n\u4E2A\u53D1\u9001\u8005" aria-hidden="true">#</a> M\u4E2A\u63A5\u53D7\u8005N\u4E2A\u53D1\u9001\u8005</h2><p>\u8FD9\u91CC\u7A0D\u5FAE\u590D\u6742\u70B9\u5C31\u662F\u4EFB\u610F\u534F\u7A0B\u901A\u8FC7\u81EA\u5DF1\u7684\u903B\u8F91\u90FD\u53EF\u4EE5\u4E3B\u52A8\u901A\u77E5\u5176\u4ED6\u534F\u7A0B\u5173\u95ED\u3002\u6240\u4EE5\u8FD9\u91CC\u5C31\u6D89\u53CA\u5230\u4E86\u5E76\u53D1\u5173\u95ED\u534F\u7A0B\u7684\u95EE\u9898\uFF0C\u8FD9\u91CC\u7528\u4E86sync.Once\u5355\u4F8B</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>
<span class="token comment">// \u5B9A\u4E49\u4E2AclsoeChan\u7684\u7C7B\u578B</span>
<span class="token keyword">type</span> CloseChan <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	ch   <span class="token keyword">chan</span> <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	once sync<span class="token punctuation">.</span>Once
<span class="token punctuation">}</span>

<span class="token comment">// \u5B9A\u4E49\u4E2AclsoeChan\u5173\u95ED\u65B9\u6CD5\uFF0C\u8FD9\u6837\u4E0D\u4F1A\u91CD\u590D\u5173\u95ED\u5BFC\u81F4\u5F02\u5E38</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>CloseChan<span class="token punctuation">)</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	c<span class="token punctuation">.</span>once<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">close</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>ch<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">NewCloseCh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>CloseChan <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>CloseChan<span class="token punctuation">{</span>
		ch<span class="token punctuation">:</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">moreReceive</span><span class="token punctuation">(</span>dataCh <span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span> closeCh <span class="token operator">*</span>CloseChan<span class="token punctuation">,</span> gNum <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">for</span> <span class="token punctuation">{</span>
		<span class="token keyword">select</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> <span class="token operator">&lt;-</span>closeCh<span class="token punctuation">.</span>ch<span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6709\u534F\u7A0B\u901A\u77E5\u5173\u95ED\u4E86&quot;</span><span class="token punctuation">,</span> gNum<span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token keyword">case</span> data <span class="token operator">:=</span> <span class="token operator">&lt;-</span>dataCh<span class="token punctuation">:</span>
			<span class="token keyword">if</span> data <span class="token operator">==</span> <span class="token number">10</span> <span class="token punctuation">{</span>
				closeCh<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;\u5728\u63A5\u53D7\u4E2D\u4E3B\u52A8\u5173\u95ED&quot;</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
			fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;\u534F\u7A0B%d\u6536\u5230\u6570\u636E%d\\n&quot;</span><span class="token punctuation">,</span> gNum<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">moreProduct</span><span class="token punctuation">(</span>dataCh <span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span> closeCh <span class="token operator">*</span>CloseChan<span class="token punctuation">,</span> gNum <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	i <span class="token operator">:=</span> <span class="token number">0</span>
	<span class="token keyword">for</span> <span class="token punctuation">{</span>
		i<span class="token operator">++</span>
		time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Millisecond <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
		<span class="token keyword">select</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> <span class="token operator">&lt;-</span>closeCh<span class="token punctuation">.</span>ch<span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;\u5199\u5165\u534F\u7A0B%d\u6536\u5230\u5173\u95ED\u901A\u77E5\\n&quot;</span><span class="token punctuation">,</span> gNum<span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token keyword">case</span> dataCh <span class="token operator">&lt;-</span> i<span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;\u5199\u5165\u534F\u7A0B%d\u53D1\u9001\u6570\u636E\u6570\u636E%d\\n&quot;</span><span class="token punctuation">,</span> gNum<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">TestMoreReceiveMoreWrite</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	dataCh <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
	closeCh <span class="token operator">:=</span> <span class="token function">NewCloseCh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token keyword">go</span> <span class="token function">moreReceive</span><span class="token punctuation">(</span>dataCh<span class="token punctuation">,</span> closeCh<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token keyword">go</span> <span class="token function">moreProduct</span><span class="token punctuation">(</span>dataCh<span class="token punctuation">,</span> closeCh<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span>
	<span class="token comment">// \u53EF\u4EE5\u591A\u5173\u95ED\u7684\u4E86\uFF0C\u501F\u52A9\u7B2C\u4E09\u65B9\u8FDB\u884C\u5173\u95ED\u64CD\u4F5C\uFF0C\u4EFB\u610F\u534F\u7A0B\u90FD\u53EF\u4EE5\u4E3B\u52A8\u5173\u95ED</span>
	closeCh<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	closeCh<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	closeCh<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">)</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;\u5269\u4F59\u534F\u7A0B\u6570\u91CF&quot;</span><span class="token punctuation">,</span> runtime<span class="token punctuation">.</span><span class="token function">NumGoroutine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,15),c=[o];function i(l,u){return s(),a("div",null,c)}var d=n(e,[["render",i],["__file","01-channel\u5173\u95ED.html.vue"]]);export{d as default};
