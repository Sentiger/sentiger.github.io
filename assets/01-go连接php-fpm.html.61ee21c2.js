import{_ as i}from"./plugin-vue_export-helper.21dcd24c.js";import{r as c,o as l,c as u,b as r,w as a,a as n,d as s,e as d}from"./app.6da40224.js";const k={},v=n("p",null,"php-fpm \u5B9E\u73B0\u4E86fast-cgi\u534F\u8BAE\uFF0C\u6240\u4EE5\u53EF\u4EE5\u548C\u5916\u90E8\u901A\u8FC7fast-cgi\u534F\u8BAE\u8FDB\u884C\u901A\u4FE1\u3002nginx+php\u5C31\u662F\u4F7F\u7528\u8FD9\u79CD\u6A21\u5F0F\u3002",-1),m=n("p",null,"\u4E0B\u9762\u6211\u4EEC\u4F7F\u7528go\u6765\u8C03\u7528\u4E0Bphp-fpm",-1),b=n("h2",{id:"\u914D\u7F6Efpm\u542F\u52A8\u6A21\u5F0F",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u914D\u7F6Efpm\u542F\u52A8\u6A21\u5F0F","aria-hidden":"true"},"#"),s(" \u914D\u7F6Efpm\u542F\u52A8\u6A21\u5F0F")],-1),g=n("p",null,"\u6709\u4E24\u79CD\u65B9\u5F0F",-1),h=n("ol",null,[n("li",null,"\u672C\u5730socket"),n("li",null,"tcp\u65B9\u5F0F")],-1),f=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token punctuation"},"["),s("www"),n("span",{class:"token punctuation"},"]"),s(`

listen `),n("span",{class:"token operator"},"="),s(` /tmp/fpm.socket

`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),_=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,[s(`
`),n("span",{class:"token punctuation"},"["),s("www"),n("span",{class:"token punctuation"},"]"),s(`

`),n("span",{class:"token punctuation"},";"),s(` \u6CE8\u610F\u8FD9\u91CC\u5982\u679C\u4EFB\u610F\u7F51\u5361\u53EF\u4EE5\u914D\u7F6E0.0.0.0

listen `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"127.0"),s(`.0.1:9000

`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),q=d(`<h2 id="go\u5BA2\u6237\u7AEF" tabindex="-1"><a class="header-anchor" href="#go\u5BA2\u6237\u7AEF" aria-hidden="true">#</a> go\u5BA2\u6237\u7AEF</h2><p>\u53EA\u8981\u5B9E\u73B0\u4E86fast-cgi\u534F\u8BAE\u7684\u90FD\u662F\u53EF\u4EE5\u8FDB\u884C\u901A\u4FE1\uFF0C\u8FD9\u5C31\u662F\u534F\u8BAE\u7684\u597D\u5904\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	fcgiclient <span class="token string">&quot;github.com/tomasen/fcgi_client&quot;</span>
	<span class="token string">&quot;io/ioutil&quot;</span>
	<span class="token string">&quot;log&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	reqParams <span class="token operator">:=</span> <span class="token string">&quot;name=value&quot;</span>
	env <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span>
	<span class="token comment">// \u8FD9\u91CC\u662F\u534F\u8BAE\u5B9A\u4E49\u7684\uFF1A\u811A\u672C\u7684\u8DEF\u5F84</span>
	env<span class="token punctuation">[</span><span class="token string">&quot;SCRIPT_FILENAME&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;/code/test.php&quot;</span>
	env<span class="token punctuation">[</span><span class="token string">&quot;SERVER_SOFTWARE&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;go / fcgiclient &quot;</span>
	env<span class="token punctuation">[</span><span class="token string">&quot;REMOTE_ADDR&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;127.0.0.1&quot;</span>
	env<span class="token punctuation">[</span><span class="token string">&quot;QUERY_STRING&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> reqParams
	<span class="token comment">// \u8FD9\u91CC\u662F\u6211\u914D\u7F6E\u7684\u8DE8\u4E3B\u673A\u901A\u4FE1</span>
	fcgi<span class="token punctuation">,</span> err <span class="token operator">:=</span> fcgiclient<span class="token punctuation">.</span><span class="token function">Dial</span><span class="token punctuation">(</span><span class="token string">&quot;tcp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;112.124.15.195:9000&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;err:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> fcgi<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;err:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	content<span class="token punctuation">,</span> err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadAll</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;err:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;content:&quot;</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a> \u603B\u7ED3</h2><p>\u8FD9\u91CC\u662Ffast-cgi\u7684\u4E00\u4E2A\u8FDE\u63A5\u6F14\u793A\uFF0C\u5177\u4F53\u534F\u8BAE\u5185\u5BB9\u65E0\u975E\u5C31\u662F\u4F7F\u7528\u89C4\u5B9A\u7684\u6570\u636E\u683C\u5F0F\u53BB\u8BF7\u6C42\u5185\u5BB9\u3002\u5177\u4F53\u534F\u8BAE\u7EC6\u8282\u53EF\u53C2\u8003\u6587\u6863</p>`,5);function w(x,E){const t=c("CodeTabs");return l(),u("div",null,[v,m,b,g,h,r(t,{data:[{title:"SOCKET"},{title:"TCP"}],"tab-id":"language"},{tab0:a(({title:e,value:p,isActive:o})=>[f]),tab1:a(({title:e,value:p,isActive:o})=>[_]),_:1}),q])}var y=i(k,[["render",w],["__file","01-go\u8FDE\u63A5php-fpm.html.vue"]]);export{y as default};
