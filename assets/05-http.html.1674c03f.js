import{_ as n}from"./plugin-vue_export-helper.21dcd24c.js";import{o as s,c as a,e as t}from"./app.7665657d.js";const p={},o=t(`<h2 id="\u8BF7\u6C42-\u54CD\u5E94\u5934" tabindex="-1"><a class="header-anchor" href="#\u8BF7\u6C42-\u54CD\u5E94\u5934" aria-hidden="true">#</a> \u8BF7\u6C42/\u54CD\u5E94\u5934</h2><h3 id="\u5206\u7247\u4F20\u8F93" tabindex="-1"><a class="header-anchor" href="#\u5206\u7247\u4F20\u8F93" aria-hidden="true">#</a> \u5206\u7247\u4F20\u8F93</h3><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;log&quot;</span>
	<span class="token string">&quot;net/http&quot;</span>
	<span class="token string">&quot;strconv&quot;</span>
	<span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// \u8FD9\u91CC\u8FD0\u7528\u4E86\u54CD\u5E94header\u5934\u4E2D\u7684chunked\uFF0C\u8FD9\u6837\u6D4F\u89C8\u5668\u5C31\u77E5\u9053\u662F\u5206\u7247\u4F20\u8F93</span>
	<span class="token comment">// \u63A5\u4E0B\u6765\u5C31\u662F\u6B63\u5E38\u6784\u5EFAhttp\u7684\u5934\u4FE1\u606F\uFF0C\u4E3B\u4F53\u4FE1\u606F\uFF0C\u4F46\u662F\u53D1\u9001\u7684\u65F6\u5019\uFF0C\u8BB0\u5F97flush</span>
	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>writer http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> request <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// \u5199\u5165header\u5934\u4FE1\u606F\uFF0Cchunked\u6D4F\u89C8\u5668\u5C31\u77E5\u9053\u8FD9\u4E2A\u662F\u5206\u7247\u4F20\u8F93</span>
		writer<span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Transfer-Encoding&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;chunked&quot;</span><span class="token punctuation">)</span>
        <span class="token comment">// \u6D4F\u89C8\u5668\u5E94\u8BE5\u5982\u4F55\u5C55\u793A\u5185\u5BB9</span>
		writer<span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/html&quot;</span><span class="token punctuation">)</span>
        <span class="token comment">// \u8FD4\u56DE\u54CD\u5E94\u7801\uFF0C200 \u6D4F\u89C8\u5668\u5C31\u6B63\u5E38\u63A5\u6536</span>
		writer<span class="token punctuation">.</span><span class="token function">WriteHeader</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">)</span>
        <span class="token comment">// \u8FD9\u91CC\u662F\u8BA9tcp\u5373\u4F7F\u6CA1\u6709\u8DB3\u591F\u5185\u5BB9\u4E5F\u76F4\u63A5\u5237\u65B0\u5230\u6D4F\u89C8\u5668\u4E2D\u3002\u8981\u4E0D\u7136\u662F\u7B49\u5230\u5185\u5BB9\u6EE1\u7684\u65F6\u5019</span>
		writer<span class="token punctuation">.</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>Flusher<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
			writer<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;flush-&quot;</span> <span class="token operator">+</span> strconv<span class="token punctuation">.</span><span class="token function">Itoa</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;&lt;br&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			writer<span class="token punctuation">.</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>Flusher<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		writer<span class="token punctuation">.</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>Flusher<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;\u542F\u52A8\u670D\u52A1 8089&quot;</span><span class="token punctuation">)</span>
	err <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:8089&quot;</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">&quot;\u542F\u52A8\u670D\u52A1\u5931\u8D25&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),e=[o];function c(u,i){return s(),a("div",null,e)}var r=n(p,[["render",c],["__file","05-http.html.vue"]]);export{r as default};
