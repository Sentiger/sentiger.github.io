import{_ as a}from"./plugin-vue_export-helper.21dcd24c.js";import{r as d,o as i,c as l,a as n,b as s,d as e,e as c}from"./app.c18382f6.js";var r="/assets/ctstate.01f3acca.png";const p={},o=n("p",null,[n("strong",null,"\u53C2\u8003\u8D44\u6599")],-1),u={href:"https://linux.die.net/man/8/iptables",target:"_blank",rel:"noopener noreferrer"},v=e("\u6587\u6863"),m={href:"https://blog.csdn.net/dhRainer/article/details/84846417",target:"_blank",rel:"noopener noreferrer"},b=e("conntrack"),h=c(`<h2 id="\u57FA\u672C\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#\u57FA\u672C\u547D\u4EE4" aria-hidden="true">#</a> \u57FA\u672C\u547D\u4EE4</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5B8C\u6574\u547D\u4EE4\u64CD\u4F5C</span>
iptables <span class="token punctuation">[</span>-t table<span class="token punctuation">]</span> CMD <span class="token punctuation">[</span>chain<span class="token punctuation">]</span> <span class="token punctuation">[</span>rules<span class="token punctuation">]</span> <span class="token punctuation">[</span>-j target<span class="token punctuation">]</span>

Usage: iptables -<span class="token punctuation">[</span>ACD<span class="token punctuation">]</span> chain rule-specification <span class="token punctuation">[</span>options<span class="token punctuation">]</span>
       iptables -I chain <span class="token punctuation">[</span>rulenum<span class="token punctuation">]</span> rule-specification <span class="token punctuation">[</span>options<span class="token punctuation">]</span>
       iptables -R chain rulenum rule-specification <span class="token punctuation">[</span>options<span class="token punctuation">]</span>
       iptables -D chain rulenum <span class="token punctuation">[</span>options<span class="token punctuation">]</span>
       iptables -<span class="token punctuation">[</span>LS<span class="token punctuation">]</span> <span class="token punctuation">[</span>chain <span class="token punctuation">[</span>rulenum<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span>
       iptables -<span class="token punctuation">[</span>FZ<span class="token punctuation">]</span> <span class="token punctuation">[</span>chain<span class="token punctuation">]</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span>
       iptables -<span class="token punctuation">[</span>NX<span class="token punctuation">]</span> chain
       iptables -E old-chain-name new-chain-name
       iptables -P chain target <span class="token punctuation">[</span>options<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="cmd" tabindex="-1"><a class="header-anchor" href="#cmd" aria-hidden="true">#</a> CMD</h3><table><thead><tr><th>\u7F29\u5199</th><th>\u5B8C\u6574\u547D\u4EE4</th><th>\u540E\u9762\u8DDF\u5185\u5BB9</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>-A</td><td>--append</td><td>chain</td><td>\u5728chain\u540E\u9762\u8FFD\u52A0\u5185\u5BB9</td></tr><tr><td>-C</td><td>--check</td><td>chain</td><td>\u68C0\u67E5\u94FE\u4E2D\u7684\u89C4\u5219\u662F\u5426\u5B58\u5728</td></tr><tr><td>-D</td><td>--delete</td><td>chain rulenum</td><td>\u5220\u9664\u94FE\u4E2D\u7684\u89C4\u5219</td></tr><tr><td>-I</td><td>--insert</td><td>chain [rulenum]</td><td>\u5728\u94FE\u4E2D\u63D2\u5165\u89C4\u5219\uFF0C\u8FD9\u4E2A\u65F6\u5019\u8981\u6307\u51FA\u63D2\u5165\u7684\u4F4D\u7F6E --line-number</td></tr><tr><td>-R</td><td>--replace</td><td>chain rulenum</td><td>\u5728\u94FE\u4E2D\u63D2\u5165\u89C4\u5219\uFF0C\u8FD9\u4E2A\u65F6\u5019\u8981\u6307\u51FA\u63D2\u5165\u7684\u4F4D\u7F6E --line-number</td></tr><tr><td>-L</td><td>--list</td><td>[chain [rulenum]]</td><td>\u5217\u51FA\u94FE\u4E0A\u7684\u89C4\u5219,\u53EF\u4EE5\u67E5\u770B\u6307\u5B9A\u884C</td></tr><tr><td>-S</td><td>--list-rules</td><td>[chain [rulenum]]</td><td>\u6253\u5370\u6307\u5B9A\u94FE\u6216\u8005\u6240\u6709\u94FE\u7684rule\uFF0C\u8FD9\u4E2A\u5C31\u662F\u80FD\u64CD\u4F5C\u7684\u547D\u4EE4</td></tr><tr><td>-F</td><td>--flush</td><td>[chain]</td><td>\u5220\u9664\u6240\u6709\u7684\u89C4\u5219\u6216\u8005\u6307\u5B9A\u94FE\u7684\u89C4\u5219</td></tr><tr><td>-Z</td><td>--zero</td><td>[chain [rulenum]]</td><td>\u6E05\u9664\u94FE\u4E0A\u7684\u8BA1\u6570\u5668</td></tr><tr><td>-N</td><td>--new</td><td>chain</td><td>\u65B0\u5EFA\u4E00\u4E2A\u81EA\u5B9A\u4E49\u94FE</td></tr><tr><td>-X</td><td>--delete-chain</td><td>[chain]</td><td>\u5220\u9664\u7528\u6237\u81EA\u5B9A\u4E49\u94FE</td></tr><tr><td>-P</td><td>--policy</td><td>chain target</td><td>\u4FEE\u6539\u94FE\u9ED8\u8BA4\u89C4\u5219 ACCEPT DROP</td></tr><tr><td>-E</td><td>--rename-chain</td><td>old-chain new-chain</td><td>\u66F4\u6539\u94FE\u540D</td></tr></tbody></table><h3 id="options" tabindex="-1"><a class="header-anchor" href="#options" aria-hidden="true">#</a> Options</h3><table><thead><tr><th>\u7F29\u5199</th><th>\u5B8C\u6574\u547D\u4EE4</th><th>\u540E\u9762\u8DDF\u5185\u5BB9</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>-4</td><td>--ipv4</td><td></td><td></td></tr><tr><td>-6</td><td>--ipv6</td><td></td><td></td></tr><tr><td>-p</td><td>--protocol</td><td>proto</td><td>\u6307\u5B9A\u534F\u8BAE tcp,udp,icmp</td></tr><tr><td>-s</td><td>--source</td><td>address[/mask][...]</td><td>\u6E90\u5730\u5740</td></tr><tr><td>-d</td><td>--destination</td><td>address[/mask][...]</td><td>\u76EE\u6807\u5730\u5740</td></tr><tr><td>-i</td><td>--in-interface</td><td>input name[+]</td><td>\u7F51\u5361</td></tr><tr><td>-j</td><td>--jump</td><td>target</td><td>\u6267\u884C\u7ED3\u679C\uFF0C\u53EF\u4EE5\u8DF3\u8F6C\u5230\u81EA\u5B9A\u4E49\u7684\u64CD\u4F5C\u94FE</td></tr><tr><td>-g</td><td>--goto</td><td>chain</td><td>\u76F4\u63A5\u8DF3\u8F6C\u5230\u94FE\u4E0A\uFF0C\u4E0D\u8FD4\u56DE</td></tr><tr><td>-m</td><td>--match</td><td>chain</td><td>\u6269\u5C55\u64CD\u4F5C</td></tr><tr><td>-n</td><td>--numeric</td><td></td><td>\u5C06\u8F93\u51FA\u7684\u8BED\u4E49\u8BCD\u4E3A\u5B8C\u6574\u7684\u6570\u5B57\u8868\u8FBE\uFF0C\u4F8B\u5982anywhere 0.0.0.0</td></tr><tr><td>-v</td><td>--verbose</td><td></td><td>\u8BE6\u7EC6\u4FE1\u606F\u5217\u51FA</td></tr><tr><td>-w</td><td>--wait</td><td>[seconds]</td><td>\u653E\u5F03\u524D\u83B7\u53D6\u8868\u9501\u7684\u6700\u957F\u7B49\u5F85\u65F6\u95F4</td></tr><tr><td>-W</td><td>--wait-interval</td><td>[usecs]</td><td>\u5C1D\u8BD5\u83B7\u53D6</td></tr><tr><td>-</td><td>--line-numbers</td><td></td><td>\u6253\u5370\u7684\u65F6\u5019\u663E\u793A\u884C\u53F7</td></tr><tr><td>-x</td><td>--exact</td><td></td><td>\u5C55\u5F00\u6570\u5B57(\u663E\u793A\u7CBE\u786E\u503C)</td></tr><tr><td>-f</td><td>--fragment</td><td></td><td>\u4EC5\u5339\u914D\u7B2C\u4E8C\u4E2A\u6216\u66F4\u591A\u7247\u6BB5</td></tr><tr><td>-</td><td>--modprobe=command</td><td></td><td>\u5C1D\u8BD5\u4F7F\u7528\u6B64\u547D\u4EE4\u63D2\u5165\u6A21\u5757</td></tr><tr><td>-</td><td>--set-counters</td><td>PKTS BYTES</td><td>\u5728\u63D2\u5165/\u9644\u52A0\u671F\u95F4\u8BBE\u7F6E\u8BA1\u6570\u5668</td></tr></tbody></table><h3 id="\u5339\u914D\u6761\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u5339\u914D\u6761\u4EF6" aria-hidden="true">#</a> \u5339\u914D\u6761\u4EF6</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u901A\u7528\u5339\u914D:
    -s \u5339\u914D\u7684\u6570\u636E\u5305\u4E2D\u6E90IP
    -d \u5339\u914D\u7684\u6570\u636E\u5305\u4E2D\u7684\u76EE\u7684IP
    -i \u5339\u914D\u4ECE\u6307\u5B9A\u63A5\u53E3\u8FDB\u6765\u7684\u6570\u636E\u5305
    -o \u5339\u914D\u6307\u5B9A\u63A5\u53E3\u5411\u5916\u53D1\u9001\u7684\u6570\u636E\u5305
  iptables -t filter -A INPUT -s 1.2.3.4 -d 4.3.2.1 -j ACCEPT     
  
\u6269\u5C55\u5339\u914D:
  1. \u9690\u5F0F\u6269\u5C55\uFF1A\u5728\u4F7F\u7528\u6269\u5C55\u5339\u914D\u65F6\u5019\uFF0C\u4E0D\u6307\u5B9A\u6269\u5C55\u6A21\u5757\u76F4\u63A5\u4F7F\u7528\u6269\u5C55\u5339\u914D
   TCP \u6269\u5C55\uFF1A
    -p: \u3010\u534F\u8BAE\u6269\u5C55\u3011\u6307\u5B9A\u6570\u636E\u5305\u7684\u534F\u8BAE\u7C7B\u578B tcp,udp,icmp  
        -p tcp --tcp-flags \u5217\u88681 \u5217\u88682  #tcp\u6807\u5FD7\u4F4D\u3002 \u5217\u88681\u6307\u5B9A\u8981\u68C0\u67E5\u7684\u6807\u5FD7\u4F4D\uFF0C\u5217\u88682\uFF1A\u6307\u5B9A\u5728\u5217\u88681\u4E2D\u6709\u7684\u6807\u5FD7\u4F4D\uFF0C\u5E76\u4E14\u6807\u5FD7\u4F4D\u4E3A1
        -p tcp --tcp-flags syn,fin,ack syn,fin   # \u5339\u914Dsyn=1,fin=1,ack=0
    --dport: \u3010\u7AEF\u53E3\u6269\u5C55\u3011 \u76EE\u7684\u7AEF\u53E3
    --sport: \u3010\u7AEF\u53E3\u6269\u5C55\u3011 \u6E90\u7AEF\u53E3
    
    iptables -t filter -A INPUT -s 1.2.3.4 -p tcp --dport 22 -j ACCEPT
   
   ICMP\u6269\u5C55: -p icmp --icmp-type
     1. \u5C06\u5BA2\u6237\u7AEF1.2.3.4\u53D1\u7684ping\u653E\u884C
      iptables -A INPUT -t filter 
  
  UDP\u6269\u5C55\uFF1A
   -p udp --dport
    
    
  2. \u663E\u793A\u6269\u5C55
    nf_conntrack
    \u4F5C\u7528\uFF1A \u53EF\u4EE5\u8FFD\u8E2A\u8BB0\u5F55\u5F53\u524D\u7CFB\u7EDF\u4E2D\u6BCF\u4E2A\u94FE\u63A5\u7684\u72B6\u6001
    /proc/net/nf_conntrack
    cfstate:\u72B6\u6001\u6A21\u5757
        NEW: \u65B0\u7684\u8FDE\u63A5\u8BF7\u6C42
        ESTABLISHED: 
        INVALID:
        RELATED:
        
    

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u793A\u4F8B" tabindex="-1"><a class="header-anchor" href="#\u793A\u4F8B" aria-hidden="true">#</a> \u793A\u4F8B</h3><p><strong>\u67E5\u770B\u4FE1\u606F</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u67E5\u770Bfilter\u8868\u5B8C\u6574\u4FE1\u606F\u4FE1\u606F</span>
iptables -L -t filter -nv

<span class="token comment"># \u67E5\u770Bfilter\u8868INPUT\u94FE\u4FE1\u606F</span>
iptables -L INPUT -t filter -nv

<span class="token comment"># \u67E5\u770Bfilter\u8868INPUT\u94FE\u7B2C\u4E00\u884C\u4FE1\u606F</span>
iptables -L INPUT <span class="token number">1</span> -nv

<span class="token comment"># \u67E5\u770Bfilter\u8868INPUT\u94FE\u7B2C1\u884C rule</span>
iptables -S INPUT <span class="token number">1</span> -t filter 
-A INPUT -p tcp -m tcp --dport <span class="token number">22</span> -m comment --comment <span class="token string">&quot;\u5141\u8BB8ssh\u8FDE\u63A5&quot;</span> -j ACCEPT
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="filter\u8868" tabindex="-1"><a class="header-anchor" href="#filter\u8868" aria-hidden="true">#</a> filter\u8868</h2><p>filter\u8868\u7684\u76F8\u5173\u64CD\u4F5C\u662F\u7528\u6765\u62E6\u622A\u6570\u636E\u7684\uFF0C\u5916\u90E8\u6570\u636E\u80FD\u5426\u8FDB\u5165\u534F\u8BAE\u6808IP\u5C42\uFF08INPUT\uFF09(FORWARD)\uFF0C\u7528\u6237\u7A7A\u95F4\u6570\u636E\u6216\u8005IP\u5C42\u6570\u636E\u80FD\u5426\u88AB\u53D1\u9001\u51FA\u53BB\u5230\u94FE\u8DEF\u5C42\uFF08OUTPUT\uFF09\u3002\u4E00\u822C\u5F53\u505A\u9632\u706B\u5899\u6765\u4F7F\u7528 \u5728\u8FD9\u4E2A\u8868\u4E2D\u6240\u4EE5\u6709\u4E09\u4E2A\u94FE\u53EF\u4EE5\u64CD\u4F5C:</p><ul><li>INPUT</li><li>FORWARD</li><li>OUTPUT</li></ul><p><strong>\u8BBE\u7F6Efilter\u8868\u4E2D\u94FE\u7684\u9ED8\u8BA4\u89C4\u5219</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#\u8BBE\u7F6E\u94FE\u9ED8\u8BA4\u62D2\u7EDD\u3001\u653E\u884C</span>
iptables -P INPUT DROP
iptables -P INPUT ACCEPT
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u76F8\u5173\u573A\u666F</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 1. \u653E\u884C22\u7AEF\u53E3</span>
iptables -A INPUT  -t filter -p tcp -s <span class="token number">0</span>/0 --dport <span class="token number">22</span> -m comment --comment <span class="token string">&quot;\u653E\u884Cssh\u8FDE\u63A5&quot;</span> -j ACCEPT

<span class="token comment"># \u5C06INPUT\u94FE\u8BBE\u7F6E\u9ED8\u8BA4\u4E3ADROP,\u8FD9\u6837\u6B64\u53F0\u670D\u52A1\u5668\u662F\u4E0D\u4F1A\u6536\u5230\u653B\u51FB\u7684\uFF08\u7A0B\u5E8F\uFF09\uFF0C\u56E0\u4E3A\u8FDB\u5165\u4E0D\u4E86INPUT\u3002\u4F46\u662F\u6570\u636E\u8FD8\u662F\u5230\u8FBE\u4E86\u94FE\u8DEF\u5C42 \uFF0C\u5728\u7F51\u7EDC\u5C42\u63A5\u53D7\u7684\u65F6\u5019\u4E22\u5F03</span>
iptables -P INPUT DROP

<span class="token comment"># \u4E0A\u9762INPUT drop,\u6240\u4EE5\u4E0D\u4EC5\u5916\u7F51\u8BBF\u95EE\u4E0D\u4E86\u672C\u673A\uFF0C\u4E14\u672C\u673A\u4E5F\u8BBF\u95EE\u4E0D\u4E86\u5916\u7F51\uFF0C\u56E0\u4E3A\u867D\u7136\u53D1\u51FA\u53BB\u6CA1\u95EE\u9898\uFF0C\u4F46\u662F\u5916\u7F51\u4F1A\u8FDB\u884C\u54CD\u5E94</span>
<span class="token comment"># \u4F8B\u5982\u60F3ping 172.31.0.3</span>
iptables -A INPUT -t filter -p icmp -s <span class="token number">172.31</span>.0.3 -m comment --comment <span class="token string">&quot;\u653E\u884Cping&quot;</span>  -j ACCEPT

<span class="token comment"># \u4E0A\u9762\u867D\u7136\u963B\u6B62\u4E86\u6240\u6709\u7684\u5916\u6765\u8BF7\u6C42\uFF0C\u4F46\u662F\u540C\u6837\u4E5F\u8BBF\u95EE\u4E0D\u4E86\u5916\u7F51\uFF0C\u8FD9\u6837\u4E0D\u53EF\u80FD\u6BCF\u6B21\u90FD\u653E\u884C\u3002\u9664\u975E\u7279\u6B8A\u539F\u56E0\uFF0C\u9650\u5236\u53EA\u80FD\u8BBF\u95EE\u54EA\u4E9B\u7F51\u7AD9</span>
<span class="token comment"># \u4F46\u662F\u60F3\u4E3B\u673A\u53EF\u4EE5\u8BBF\u95EE\u4EFB\u610F\u5916\u7F51\u3002\u4E0B\u9762\u8FD9\u4E2A\u64CD\u4F5C\u662F\u4F7F\u7528conntrack\u6A21\u5757\u6765\u67E5\u627E\u53D1\u51FA\u53BB\u7684\u5305\u80FD\u5339\u914D\u76F4\u63A5\u653E\u884C</span>
iptables -A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="nat\u8868" tabindex="-1"><a class="header-anchor" href="#nat\u8868" aria-hidden="true">#</a> nat\u8868</h2><p>nat\u8868\u4E3B\u8981\u662F\u7528\u6765\u505A\u5730\u5740\u8F6C\u6362\u7684\u3002<code>SNAT</code>, <code>DNAT</code>, <code>LOG</code> \u6240\u4EE5\u6D89\u53CA\u5230\u7684\u94FE\u6709\uFF1A</p><ul><li>PREROUTING</li><li>INPUT</li><li>OUTPUT</li><li>POSTROUTING</li></ul><p>\u7F51\u5361-&gt;\u9632\u706B\u5899-&gt;\u7528\u6237\u7A7A\u95F4</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 1. \u5730\u5740\u8F6C\u6362\uFF0C\u8BBF\u95EE\u672C\u673A\u768480\uFF0C\u7136\u540E\u8BBF\u95EE\u5176\u4ED6\u7684ip\u3002\uFF08\u505A\u4EE3\u7406\u7528\uFF09\u7528\u5230\u4E86ip_conntrack\u6A21\u5757</span>
<span class="token comment">## \u5C06\u8BBF\u95EE\u672C\u673A\u768480\u7AEF\u53E3\uFF0C\u7136\u540E\u76F4\u63A5\u76F4\u63A5\u8F6C\u53D1\u5230\u53E6\u4E00\u4E2Aip</span>
iptables -t nat -A PREROUTING -p tcp --dport <span class="token number">80</span> -j DNAT --to-destination <span class="token number">139.198</span>.165.7:80
<span class="token comment">## \u7136\u540E\u8FDB\u5165\u4E86output-&gt;postrouting \u6B64\u65F6ip\u662F\u8FD9\u6837\u7684 clientIP:80 -&gt; 139.198.165.7:80</span>
<span class="token comment">## \u56E0\u4E3A139.198.165.7:80\u8981\u56DE\u6570\u636E\u5305\uFF0C\u603B\u4E0D\u80FD\u76F4\u63A5\u56DE\u7ED9client\uFF0C\u6240\u4EE5\u8FD9\u6837\u8FD8\u8981\u505A\u4E00\u6B21\u8F6C\u6362\u3002\u6539\u53D8\u539F\u5730\u5740</span>
iptables -t nat -A POSTROUTING -d <span class="token number">120.26</span>.148.228  -j SNAT --to-source <span class="token number">172.31</span>.0.2
<span class="token comment">## \u8FD9\u6837\u4EE3\u7406\u670D\u52A1\u5668\u6536\u5230\u6570\u636E\u4E4B\u540E\u4F1A\u76F4\u63A5\u8FD4\u56DE\u7ED9client\u3002\u6B64\u65F6\u662F\u901A\u8FC7/proc/net/nf_conntrack \u8FD9\u4E2A\u6587\u4EF6\u8BB0\u5F55\u7684\u6570\u636E\u6765\u7684\u3002\u4F7F\u7528\u7684\u662Fconntrack\u6A21\u5757</span>

<span class="token comment">## \u667A\u80FD\u7684 MASQUERADE\u3002\u8FD9\u4E2A\u662F\u53D1\u9001\u5230\u7F51\u5361\u7684\u65F6\u5019\uFF0C\u81EA\u52A8\u7684\u4FEE\u6539\u6E90\u5730\u5740\u3002\u597D\u5904\u5C31\u662F\u5982\u679C\u591A\u4E2A\u7F51\u5361\u7684\u65F6\u5019\uFF0C\u81EA\u52A8\u8BC6\u522B\u4F7F\u7528\u54EA\u4E2A\u51FA\u53E3ip\u3002\u4E0D\u7528\u6307\u5B9A</span>
iptables -t nat -A POSTROUTING -d <span class="token number">120.26</span>.148.228  -j SNAT MASQUERADE

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u6269\u5C55\u6A21\u5757" tabindex="-1"><a class="header-anchor" href="#\u6269\u5C55\u6A21\u5757" aria-hidden="true">#</a> \u6269\u5C55\u6A21\u5757</h2><h3 id="conntrack" tabindex="-1"><a class="header-anchor" href="#conntrack" aria-hidden="true">#</a> conntrack</h3><p>ctstate\u4F1A\u8BB0\u5F55\u6BCF\u4E2A\u8FDE\u63A5\u7684\u72B6\u6001</p><p><img src="`+r+`" alt="img.png" loading="lazy"></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>ipv4     2 tcp      6 118 SYN_SENT src=172.31.0.2 dst=172.31.0.45 sport=53418 dport=80 [UNREPLIED] src=172.31.0.45 dst=172.31.0.2 sport=80 dport=53418 mark=0 zone=0 use=3

ipv4     2 tcp      6 300 ESTABLISHED src=122.224.68.82 dst=172.31.0.2 sport=62120 dport=22 src=172.31.0.2 dst=122.224.68.82 sport=22 dport=62120 [ASSURED] mark=0 zone=0 use=2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,28);function k(g,T){const t=d("ExternalLinkIcon");return i(),l("div",null,[o,n("ul",null,[n("li",null,[n("a",u,[v,s(t)])]),n("li",null,[n("a",m,[b,s(t)])])]),h])}var I=a(p,[["render",k],["__file","03-iptables.html.vue"]]);export{I as default};
