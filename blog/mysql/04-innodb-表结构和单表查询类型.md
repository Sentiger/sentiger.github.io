---
title: Innodb表空间&单表查询
order: 4
category:
  - MySQL
---

innodb存储数据以页为单位，是为了一次性读取多一点数据到内存中，也是为了效率。对于磁盘的优化，存储的优化，所以还衍生出来了表空间，区，段等逻辑上的概念。



## 表空间

数据是存储在磁盘上以页为单位，具体是存储在哪个文件，innodb分了表空间的概念，例如创建表的时候，可以是独立表空间，或者是系统表空间。

### 系统表空间

创建表的时候，数据存储是在系统表空间中。也就是数据都存储在一个文件中。可以进行修改:

## 默认数据库

**mysql**

这个数据库贼核心，它存储了MySQL的用户账户和权限信息，一些存储过程、事件的定义信息，一些运行过 程中产生的日志信息，一些帮助信息以及时区信息等。

**information_schema**

这个数据库保存着MySQL服务器维护的所有其他数据库的信息，比如有哪些表、哪些视图、哪些触发器、哪 些列、哪些索引吧啦吧啦。这些信息并不是真实的用户数据，而是一些描述性信息，有时候也称之为元数 据。

**performance_schema**

这个数据库里主要保存MySQL服务器运行过程中的一些状态信息，算是对MySQL服务器的一个性能监控。 包括统计最近执行了哪些语句，在执行过程的每个阶段都花费了多长时间，内存的使用情况等等信息。

**sys**

这个数据库主要是通过视图的形式把 information_schema 和 performance_schema 结合起来，让程序员可以 更方便的了解MySQL服务器的一些性能信息。

```shell
[server]
innodb_data_file_path=data1:512M;data2:512M:autoextend
```

### 独立表空间

每个表的数据存储都是独立文件存储的，有一个好处就是容易维护点，例如删除表，会释放空间，而存储在系统表空间中，是没法是放空间，只能靠压缩。

## 区
区的引入其实是为了管理页，一个区的大小默认是1M，因为数据在磁盘上存储，越靠近在一起，查询速度越快。所以一次性申请N个区。


## 段

对于索引非叶子节点页，和叶子节点等信息，因为叶子节点信息比较大，所以全都用一个区来表示，可能很快就被沾满了。所以这里就在存储上特殊处理。

分为数据段，和索引段


## 单表查询

单表查询类型有很多种，可以定义为以下：


### const

1. 索引是唯一的
2. 等值查询

```sql
select * from table where unique_key = 'data';
```

### ref

1. 普通索引
2. 等值查询

```sql
select * from table where index_key = 'data';
```


### ref_or_null

innodb中普通索引，唯一索引对null值都没有限定

1. 索引
2. or查询带有null的

```sql
select * from table where key = 'data' or key is null;
```

### range

范围查找

1. 索引字段
2. 查询条件是一个范围

```sql
select * from table where key > 333 and key < 666;
```

### index

全表扫描二级索引

1. 查询的条件字段用不到索引
2. 查询的字段值在索引里面
3. 其实就是联合索引查找了

```sql
1. key1,key2,key3是联合索引
2. 查询条件是key3,这个是用不了索引的
3. 直接全表扫描联合索引就能找到对应的主键


select key1,key2,key3 from table where key3 ='xx';
```

### all

就是全表扫描聚簇索引。从第一个开始查找
