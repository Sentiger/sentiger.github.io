---
title: x86汇编
order: 10
date: 2022-11-23
category:
  - linux
  - 汇编
---

## CPU

- cpu外部总线接口，逻辑算数单元部件（包含寄存器），控制接口组成。
- cpu在出厂的时候就设置了很多指令，这些指令组合在一起构成了指令集。
- N位CPU表示CPU里面的寄存器能存储数据的位数，64位则是寄存器能存64位的数据
- CPU取内存中的指令是通过读取指令指针寄存器中的地址，然后读取到CPU中，然后执行，最后根据读取完的指令大小加上当前指令指针寄存器中的地址，然后存放到指针指令寄存器，也就是下次CPU要执行的指令地址。

## 总线

- 总线主要是和CPU和外部设备打交道的。
- 地址总线是CPU传递数据用的，每一根线能表示1或者0，地址总线是在内存中寻址的，告诉CPU想操作内存哪个单元的数据。所以地址总线的长度决定最大使用内存的大小，每一个内存单元存储1字节。地址总线能寻址的是内存单元
- 数据总线是用来传递数据的，地址总线的根数称为宽度，也就是每新增一个线则多传递1位
- 控制总线控制CPU是读取数据还是写入数据

## 寄存器

- 寄存器是在CPU中临时存放数据的。
- 不同类型的寄存器作用也是不一样的。

## x8086实模式下访问内存

![x8086-memory](./assets/x8086-memory.png)

- 地址总线是20根，最大访问内存就是2^20Byte=1024K=1M。所以内存最大是1M
- 数据总线是16根  最大的传输数据是16位=2字节
- 寄存器是16位的，最大能存储2字节
- 内存使用了分段模式
- 访问内存采用了数据段方式，逻辑地址表示方式
- `CS`存储的是代码段起始位置的逻辑地址
- `DS`存储的是数据段起始位置的逻辑地址
- `IP`存储的是指令指针相对于`CS`的偏移地址
- 内存的逻辑访问方式：`逻辑起始位置 偏移地址`
- `CS`代码段寄存器，里面存储的是代码段的起始位置，因为最大存储的是FFFF，16位，但是地址总线是20位，所以访问不了整个内存。
- 针对于16位寄存器，20位地址总线，所以将内存分段，内存地址最后4位是0的都可以当做是代码段CS,或者数据段DS的起始位置，用逻辑表示，里面存储的是将真实地址右移动4位，然后取地址的时候就是传送到地址线就左移动4位然后加上偏移地址

